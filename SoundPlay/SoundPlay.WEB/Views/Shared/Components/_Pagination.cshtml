@model PagedInfoViewModel

@{
    var actualPage = nameof(Model.PageId);
    var sourceRouteData = Context.Request.Query.ToDictionary(x => x.Key, x => x.Value.ToString());
    if (sourceRouteData.ContainsKey(actualPage))
    {
        sourceRouteData.Remove(actualPage);
    }

    var prevRouteData = new Dictionary<string, string>(sourceRouteData);
    prevRouteData.Add(actualPage, (Model.PageId - 1).ToString());

    var nextRouteData = new Dictionary<string, string>(sourceRouteData);
    nextRouteData.Add(actualPage, (Model.PageId + 1).ToString());

    
    List<Dictionary<string, string>> pagesRouteData = new();

    for (int i = 0; i < Model.TotalPages; i++)
    {
        var routeData = new Dictionary<string, string>(sourceRouteData);

        routeData.Add(actualPage, (i).ToString());
        pagesRouteData.Insert(i, routeData);
    }
}

<div class="col-12 text-end">
    @if (Model.TotalPages == 0)
    {
        <p class="p-2"></p>
    }
    else
    {
        <p class="text-muted">Page @(Model.PageId + 1) - @Model.TotalPages</p>
    }
</div>

<hr class="featurette-divider">

<nav ari a-label="Page navigation example">
    <div class="esh-pager"></div>
    <ul class="pagination pagination-sm justify-content-end">

        @if (Model.HasPreviousPage)
        {
            <li class="page-item">
                <a class="page-link" asp-all-route-data="prevRouteData">
                    <span aria-hidden="true"><i class="bi bi-chevron-double-left"></i></span>
                </a>
            </li>
        }

        @for (int i = 0; i < pagesRouteData.Count; i++)
        {
            var numPage = i + 1;

            var pageRouteData = pagesRouteData[i];
            if (Model.PageId == i)
            {
                <li class="page-item active">
                    <a class="page-link" asp-all-route-data="pageRouteData">@numPage</a>
                </li>
            }
            else
            {
                <li class="page-item">
                    <a class="page-link" asp-all-route-data="pageRouteData">@numPage</a>
                </li>              
            }
        }

        @if (Model.HasNextPage)
        {
            <li class="page-item">
                <a class="page-link" asp-all-route-data="nextRouteData">
                    <span aria-hidden="true"><i class="bi bi-chevron-double-right"></i></span>
                </a>
            </li>
        } 

    </ul>
</nav>